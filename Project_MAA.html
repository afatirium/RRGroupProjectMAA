<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Allahverdili Minaya, Aliev Aziz, Ibadova Afet">
<meta name="dcterms.date" content="2023-06-15">

<title>Project_MAA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Project_MAA_files/libs/clipboard/clipboard.min.js"></script>
<script src="Project_MAA_files/libs/quarto-html/quarto.js"></script>
<script src="Project_MAA_files/libs/quarto-html/popper.min.js"></script>
<script src="Project_MAA_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Project_MAA_files/libs/quarto-html/anchor.min.js"></script>
<link href="Project_MAA_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Project_MAA_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Project_MAA_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Project_MAA_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Project_MAA_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project_MAA</h1>
<p class="subtitle lead">House pricing Model</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Allahverdili Minaya, Aliev Aziz, Ibadova Afet </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 15, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="preparing-libraries" class="level1">
<h1>Preparing Libraries</h1>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-1_a329be11389622ce47873af6be99ce9d">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install libraries</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("beanplot")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("summarytools")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ggplot2")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidyr")</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("gridExtra")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("scales")</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("zoo")</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("dplyr")</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("gbm")</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("glmnet")</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("xgboost")</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("e1071")</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("caret")</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("rpart")</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ada")</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="do">##Import libraries</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(beanplot)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gbm)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-dataset" class="level1">
<h1>Load Dataset</h1>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-2_dfb3405c1edab6bdc6fe83eada725694">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"train.csv"</span>, <span class="at">h=</span>T)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"test.csv"</span>, <span class="at">h=</span>T)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(train) <span class="ot">&lt;-</span> train<span class="sc">$</span>Id</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>Id <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(test) <span class="ot">&lt;-</span> test<span class="sc">$</span>Id</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>Id <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/Afat/Documents/GitHub/RRGroupProjectMAA"</code></pre>
</div>
</div>
</section>
<section id="data-exploration-and-preprocessing" class="level1">
<h1>Data Exploration and Preprocessing</h1>
<section id="investigate-target-value-distribution" class="level2">
<h2 class="anchored" data-anchor-id="investigate-target-value-distribution">1. Investigate TARGET value distribution</h2>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-3_a51134e433e942c7f0c625192c65809b">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>)) <span class="co"># Adjusting the margins for better visualization</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Subplot 1</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(train<span class="sc">$</span>SalePrice, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">"Sales Price Distribution"</span>, <span class="at">xlab =</span> <span class="st">"Sale Price"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Counts"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border =</span> <span class="st">"white"</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(train<span class="sc">$</span>SalePrice), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>(train<span class="sc">$</span>SalePrice), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Mean"</span>, <span class="st">"Median"</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Subplot 2</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train<span class="sc">$</span>SalePrice, <span class="fu">rnorm</span>(<span class="fu">nrow</span>(train), <span class="at">mean =</span> <span class="dv">7</span>, <span class="at">sd =</span> <span class="fl">0.2</span>), <span class="at">main =</span> <span class="st">"Sales Price Distribution"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Sale Price"</span>, <span class="at">ylab =</span> <span class="st">"Random Values"</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Subplot 3</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(train<span class="sc">$</span>SalePrice, <span class="at">main =</span> <span class="st">"Sales Price Distribution"</span>, <span class="at">ylab =</span> <span class="st">"Sale Price"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"lightgreen"</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Note:</strong> Target is is continuous, and the distribution is skewed to the right. Mostly house price ranges from 100,000 to 200,000.</p>
</section>
<section id="investigate-data-types" class="level2">
<h2 class="anchored" data-anchor-id="investigate-data-types">2. Investigate Data Types</h2>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-4_86b4a7fe79f9cb8d65ecc80892235f3f">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(train)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1460 obs. of  80 variables:
 $ MSSubClass   : int  60 20 60 70 60 50 20 60 50 190 ...
 $ MSZoning     : chr  "RL" "RL" "RL" "RL" ...
 $ LotFrontage  : int  65 80 68 60 84 85 75 NA 51 50 ...
 $ LotArea      : int  8450 9600 11250 9550 14260 14115 10084 10382 6120 7420 ...
 $ Street       : chr  "Pave" "Pave" "Pave" "Pave" ...
 $ Alley        : chr  NA NA NA NA ...
 $ LotShape     : chr  "Reg" "Reg" "IR1" "IR1" ...
 $ LandContour  : chr  "Lvl" "Lvl" "Lvl" "Lvl" ...
 $ Utilities    : chr  "AllPub" "AllPub" "AllPub" "AllPub" ...
 $ LotConfig    : chr  "Inside" "FR2" "Inside" "Corner" ...
 $ LandSlope    : chr  "Gtl" "Gtl" "Gtl" "Gtl" ...
 $ Neighborhood : chr  "CollgCr" "Veenker" "CollgCr" "Crawfor" ...
 $ Condition1   : chr  "Norm" "Feedr" "Norm" "Norm" ...
 $ Condition2   : chr  "Norm" "Norm" "Norm" "Norm" ...
 $ BldgType     : chr  "1Fam" "1Fam" "1Fam" "1Fam" ...
 $ HouseStyle   : chr  "2Story" "1Story" "2Story" "2Story" ...
 $ OverallQual  : int  7 6 7 7 8 5 8 7 7 5 ...
 $ OverallCond  : int  5 8 5 5 5 5 5 6 5 6 ...
 $ YearBuilt    : int  2003 1976 2001 1915 2000 1993 2004 1973 1931 1939 ...
 $ YearRemodAdd : int  2003 1976 2002 1970 2000 1995 2005 1973 1950 1950 ...
 $ RoofStyle    : chr  "Gable" "Gable" "Gable" "Gable" ...
 $ RoofMatl     : chr  "CompShg" "CompShg" "CompShg" "CompShg" ...
 $ Exterior1st  : chr  "VinylSd" "MetalSd" "VinylSd" "Wd Sdng" ...
 $ Exterior2nd  : chr  "VinylSd" "MetalSd" "VinylSd" "Wd Shng" ...
 $ MasVnrType   : chr  "BrkFace" "None" "BrkFace" "None" ...
 $ MasVnrArea   : int  196 0 162 0 350 0 186 240 0 0 ...
 $ ExterQual    : chr  "Gd" "TA" "Gd" "TA" ...
 $ ExterCond    : chr  "TA" "TA" "TA" "TA" ...
 $ Foundation   : chr  "PConc" "CBlock" "PConc" "BrkTil" ...
 $ BsmtQual     : chr  "Gd" "Gd" "Gd" "TA" ...
 $ BsmtCond     : chr  "TA" "TA" "TA" "Gd" ...
 $ BsmtExposure : chr  "No" "Gd" "Mn" "No" ...
 $ BsmtFinType1 : chr  "GLQ" "ALQ" "GLQ" "ALQ" ...
 $ BsmtFinSF1   : int  706 978 486 216 655 732 1369 859 0 851 ...
 $ BsmtFinType2 : chr  "Unf" "Unf" "Unf" "Unf" ...
 $ BsmtFinSF2   : int  0 0 0 0 0 0 0 32 0 0 ...
 $ BsmtUnfSF    : int  150 284 434 540 490 64 317 216 952 140 ...
 $ TotalBsmtSF  : int  856 1262 920 756 1145 796 1686 1107 952 991 ...
 $ Heating      : chr  "GasA" "GasA" "GasA" "GasA" ...
 $ HeatingQC    : chr  "Ex" "Ex" "Ex" "Gd" ...
 $ CentralAir   : chr  "Y" "Y" "Y" "Y" ...
 $ Electrical   : chr  "SBrkr" "SBrkr" "SBrkr" "SBrkr" ...
 $ X1stFlrSF    : int  856 1262 920 961 1145 796 1694 1107 1022 1077 ...
 $ X2ndFlrSF    : int  854 0 866 756 1053 566 0 983 752 0 ...
 $ LowQualFinSF : int  0 0 0 0 0 0 0 0 0 0 ...
 $ GrLivArea    : int  1710 1262 1786 1717 2198 1362 1694 2090 1774 1077 ...
 $ BsmtFullBath : int  1 0 1 1 1 1 1 1 0 1 ...
 $ BsmtHalfBath : int  0 1 0 0 0 0 0 0 0 0 ...
 $ FullBath     : int  2 2 2 1 2 1 2 2 2 1 ...
 $ HalfBath     : int  1 0 1 0 1 1 0 1 0 0 ...
 $ BedroomAbvGr : int  3 3 3 3 4 1 3 3 2 2 ...
 $ KitchenAbvGr : int  1 1 1 1 1 1 1 1 2 2 ...
 $ KitchenQual  : chr  "Gd" "TA" "Gd" "Gd" ...
 $ TotRmsAbvGrd : int  8 6 6 7 9 5 7 7 8 5 ...
 $ Functional   : chr  "Typ" "Typ" "Typ" "Typ" ...
 $ Fireplaces   : int  0 1 1 1 1 0 1 2 2 2 ...
 $ FireplaceQu  : chr  NA "TA" "TA" "Gd" ...
 $ GarageType   : chr  "Attchd" "Attchd" "Attchd" "Detchd" ...
 $ GarageYrBlt  : int  2003 1976 2001 1998 2000 1993 2004 1973 1931 1939 ...
 $ GarageFinish : chr  "RFn" "RFn" "RFn" "Unf" ...
 $ GarageCars   : int  2 2 2 3 3 2 2 2 2 1 ...
 $ GarageArea   : int  548 460 608 642 836 480 636 484 468 205 ...
 $ GarageQual   : chr  "TA" "TA" "TA" "TA" ...
 $ GarageCond   : chr  "TA" "TA" "TA" "TA" ...
 $ PavedDrive   : chr  "Y" "Y" "Y" "Y" ...
 $ WoodDeckSF   : int  0 298 0 0 192 40 255 235 90 0 ...
 $ OpenPorchSF  : int  61 0 42 35 84 30 57 204 0 4 ...
 $ EnclosedPorch: int  0 0 0 272 0 0 0 228 205 0 ...
 $ X3SsnPorch   : int  0 0 0 0 0 320 0 0 0 0 ...
 $ ScreenPorch  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PoolArea     : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PoolQC       : chr  NA NA NA NA ...
 $ Fence        : chr  NA NA NA NA ...
 $ MiscFeature  : chr  NA NA NA NA ...
 $ MiscVal      : int  0 0 0 0 0 700 0 350 0 0 ...
 $ MoSold       : int  2 5 9 2 12 10 8 11 4 1 ...
 $ YrSold       : int  2008 2007 2008 2006 2008 2009 2007 2009 2008 2008 ...
 $ SaleType     : chr  "WD" "WD" "WD" "WD" ...
 $ SaleCondition: chr  "Normal" "Normal" "Normal" "Abnorml" ...
 $ SalePrice    : int  208500 181500 223500 140000 250000 143000 307000 200000 129900 118000 ...</code></pre>
</div>
</div>
<ul>
<li><p>Some variables, such as <strong>YearBuilt, YearRemodAdd, GarageYrBlt, YrSold, MoSold</strong> are numeric variables, which is related to the year.</p></li>
<li><p>Some variables have a lot of null value, it can be cleaned.</p></li>
</ul>
<section id="explore-the-categorical-variables" class="level3">
<h3 class="anchored" data-anchor-id="explore-the-categorical-variables">2.1. Explore the categorical variables</h3>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-5_74bfe57d56c078f3bcd64badc726b09c">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cat_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(train)[<span class="fu">sapply</span>(train, is.character)]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>cat_vars </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "MSZoning"      "Street"        "Alley"         "LotShape"     
 [5] "LandContour"   "Utilities"     "LotConfig"     "LandSlope"    
 [9] "Neighborhood"  "Condition1"    "Condition2"    "BldgType"     
[13] "HouseStyle"    "RoofStyle"     "RoofMatl"      "Exterior1st"  
[17] "Exterior2nd"   "MasVnrType"    "ExterQual"     "ExterCond"    
[21] "Foundation"    "BsmtQual"      "BsmtCond"      "BsmtExposure" 
[25] "BsmtFinType1"  "BsmtFinType2"  "Heating"       "HeatingQC"    
[29] "CentralAir"    "Electrical"    "KitchenQual"   "Functional"   
[33] "FireplaceQu"   "GarageType"    "GarageFinish"  "GarageQual"   
[37] "GarageCond"    "PavedDrive"    "PoolQC"        "Fence"        
[41] "MiscFeature"   "SaleType"      "SaleCondition"</code></pre>
</div>
</div>
<p><strong>MSSubClass</strong> is also categorical by definition, despite its numeric values. MSSubClass should be added to the list of categorical variables.</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-6_c827625782de3756e20606cab1c20aed">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cat_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(cat_vars, <span class="st">"MSSubClass"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(cat_vars)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44</code></pre>
</div>
</div>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-7_cb5871c2f058b05e9591a7a0650a39e0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>train[cat_vars] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(train[cat_vars], as.character)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">sapply</span>(train[cat_vars], summary))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Length Class       Mode       
MSZoning      "1460" "character" "character"
Street        "1460" "character" "character"
Alley         "1460" "character" "character"
LotShape      "1460" "character" "character"
LandContour   "1460" "character" "character"
Utilities     "1460" "character" "character"
LotConfig     "1460" "character" "character"
LandSlope     "1460" "character" "character"
Neighborhood  "1460" "character" "character"
Condition1    "1460" "character" "character"
Condition2    "1460" "character" "character"
BldgType      "1460" "character" "character"
HouseStyle    "1460" "character" "character"
RoofStyle     "1460" "character" "character"
RoofMatl      "1460" "character" "character"
Exterior1st   "1460" "character" "character"
Exterior2nd   "1460" "character" "character"
MasVnrType    "1460" "character" "character"
ExterQual     "1460" "character" "character"
ExterCond     "1460" "character" "character"
Foundation    "1460" "character" "character"
BsmtQual      "1460" "character" "character"
BsmtCond      "1460" "character" "character"
BsmtExposure  "1460" "character" "character"
BsmtFinType1  "1460" "character" "character"
BsmtFinType2  "1460" "character" "character"
Heating       "1460" "character" "character"
HeatingQC     "1460" "character" "character"
CentralAir    "1460" "character" "character"
Electrical    "1460" "character" "character"
KitchenQual   "1460" "character" "character"
Functional    "1460" "character" "character"
FireplaceQu   "1460" "character" "character"
GarageType    "1460" "character" "character"
GarageFinish  "1460" "character" "character"
GarageQual    "1460" "character" "character"
GarageCond    "1460" "character" "character"
PavedDrive    "1460" "character" "character"
PoolQC        "1460" "character" "character"
Fence         "1460" "character" "character"
MiscFeature   "1460" "character" "character"
SaleType      "1460" "character" "character"
SaleCondition "1460" "character" "character"
MSSubClass    "1460" "character" "character"</code></pre>
</div>
</div>
<p><strong>Summary for categorical variables:</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-8_bf21ba55b932f67d2f3f90d41db0582c">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dfSummary</span>(train[cat_vars]) </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data Frame Summary  
train  
Dimensions: 1460 x 44  
Duplicates: 21  

-----------------------------------------------------------------------------------------------------
No   Variable        Stats / Values   Freqs (% of Valid)   Graph                 Valid      Missing  
---- --------------- ---------------- -------------------- --------------------- ---------- ---------
1    MSZoning        1. C (all)         10 ( 0.7%)                               1460       0        
     [character]     2. FV              65 ( 4.5%)                               (100.0%)   (0.0%)   
                     3. RH              16 ( 1.1%)                                                   
                     4. RL            1151 (78.8%)         IIIIIIIIIIIIIII                           
                     5. RM             218 (14.9%)         II                                        

2    Street          1. Grvl             6 ( 0.4%)                               1460       0        
     [character]     2. Pave          1454 (99.6%)         IIIIIIIIIIIIIIIIIII   (100.0%)   (0.0%)   

3    Alley           1. Grvl          50 (54.9%)           IIIIIIIIII            91         1369     
     [character]     2. Pave          41 (45.1%)           IIIIIIIII             (6.2%)     (93.8%)  

4    LotShape        1. IR1           484 (33.2%)          IIIIII                1460       0        
     [character]     2. IR2            41 ( 2.8%)                                (100.0%)   (0.0%)   
                     3. IR3            10 ( 0.7%)                                                    
                     4. Reg           925 (63.4%)          IIIIIIIIIIII                              

5    LandContour     1. Bnk             63 ( 4.3%)                               1460       0        
     [character]     2. HLS             50 ( 3.4%)                               (100.0%)   (0.0%)   
                     3. Low             36 ( 2.5%)                                                   
                     4. Lvl           1311 (89.8%)         IIIIIIIIIIIIIIIII                         

6    Utilities       1. AllPub        1459 (99.9%)         IIIIIIIIIIIIIIIIIII   1460       0        
     [character]     2. NoSeWa           1 ( 0.1%)                               (100.0%)   (0.0%)   

7    LotConfig       1. Corner         263 (18.0%)         III                   1460       0        
     [character]     2. CulDSac         94 ( 6.4%)         I                     (100.0%)   (0.0%)   
                     3. FR2             47 ( 3.2%)                                                   
                     4. FR3              4 ( 0.3%)                                                   
                     5. Inside        1052 (72.1%)         IIIIIIIIIIIIII                            

8    LandSlope       1. Gtl           1382 (94.7%)         IIIIIIIIIIIIIIIIII    1460       0        
     [character]     2. Mod             65 ( 4.5%)                               (100.0%)   (0.0%)   
                     3. Sev             13 ( 0.9%)                                                   

9    Neighborhood    1. NAmes         225 (15.4%)          III                   1460       0        
     [character]     2. CollgCr       150 (10.3%)          II                    (100.0%)   (0.0%)   
                     3. OldTown       113 ( 7.7%)          I                                         
                     4. Edwards       100 ( 6.8%)          I                                         
                     5. Somerst        86 ( 5.9%)          I                                         
                     6. Gilbert        79 ( 5.4%)          I                                         
                     7. NridgHt        77 ( 5.3%)          I                                         
                     8. Sawyer         74 ( 5.1%)          I                                         
                     9. NWAmes         73 ( 5.0%)          I                                         
                     10. SawyerW       59 ( 4.0%)                                                    
                     [ 15 others ]    424 (29.0%)          IIIII                                     

10   Condition1      1. Artery          48 ( 3.3%)                               1460       0        
     [character]     2. Feedr           81 ( 5.5%)         I                     (100.0%)   (0.0%)   
                     3. Norm          1260 (86.3%)         IIIIIIIIIIIIIIIII                         
                     4. PosA             8 ( 0.5%)                                                   
                     5. PosN            19 ( 1.3%)                                                   
                     6. RRAe            11 ( 0.8%)                                                   
                     7. RRAn            26 ( 1.8%)                                                   
                     8. RRNe             2 ( 0.1%)                                                   
                     9. RRNn             5 ( 0.3%)                                                   

11   Condition2      1. Artery           2 ( 0.1%)                               1460       0        
     [character]     2. Feedr            6 ( 0.4%)                               (100.0%)   (0.0%)   
                     3. Norm          1445 (99.0%)         IIIIIIIIIIIIIIIIIII                       
                     4. PosA             1 ( 0.1%)                                                   
                     5. PosN             2 ( 0.1%)                                                   
                     6. RRAe             1 ( 0.1%)                                                   
                     7. RRAn             1 ( 0.1%)                                                   
                     8. RRNn             2 ( 0.1%)                                                   

12   BldgType        1. 1Fam          1220 (83.6%)         IIIIIIIIIIIIIIII      1460       0        
     [character]     2. 2fmCon          31 ( 2.1%)                               (100.0%)   (0.0%)   
                     3. Duplex          52 ( 3.6%)                                                   
                     4. Twnhs           43 ( 2.9%)                                                   
                     5. TwnhsE         114 ( 7.8%)         I                                         

13   HouseStyle      1. 1.5Fin        154 (10.5%)          II                    1460       0        
     [character]     2. 1.5Unf         14 ( 1.0%)                                (100.0%)   (0.0%)   
                     3. 1Story        726 (49.7%)          IIIIIIIII                                 
                     4. 2.5Fin          8 ( 0.5%)                                                    
                     5. 2.5Unf         11 ( 0.8%)                                                    
                     6. 2Story        445 (30.5%)          IIIIII                                    
                     7. SFoyer         37 ( 2.5%)                                                    
                     8. SLvl           65 ( 4.5%)                                                    

14   RoofStyle       1. Flat            13 ( 0.9%)                               1460       0        
     [character]     2. Gable         1141 (78.2%)         IIIIIIIIIIIIIII       (100.0%)   (0.0%)   
                     3. Gambrel         11 ( 0.8%)                                                   
                     4. Hip            286 (19.6%)         III                                       
                     5. Mansard          7 ( 0.5%)                                                   
                     6. Shed             2 ( 0.1%)                                                   

15   RoofMatl        1. ClyTile          1 ( 0.1%)                               1460       0        
     [character]     2. CompShg       1434 (98.2%)         IIIIIIIIIIIIIIIIIII   (100.0%)   (0.0%)   
                     3. Membran          1 ( 0.1%)                                                   
                     4. Metal            1 ( 0.1%)                                                   
                     5. Roll             1 ( 0.1%)                                                   
                     6. Tar&amp;Grv         11 ( 0.8%)                                                   
                     7. WdShake          5 ( 0.3%)                                                   
                     8. WdShngl          6 ( 0.4%)                                                   

16   Exterior1st     1. VinylSd       515 (35.3%)          IIIIIII               1460       0        
     [character]     2. HdBoard       222 (15.2%)          III                   (100.0%)   (0.0%)   
                     3. MetalSd       220 (15.1%)          III                                       
                     4. Wd Sdng       206 (14.1%)          II                                        
                     5. Plywood       108 ( 7.4%)          I                                         
                     6. CemntBd        61 ( 4.2%)                                                    
                     7. BrkFace        50 ( 3.4%)                                                    
                     8. WdShing        26 ( 1.8%)                                                    
                     9. Stucco         25 ( 1.7%)                                                    
                     10. AsbShng       20 ( 1.4%)                                                    
                     [ 5 others ]       7 ( 0.5%)                                                    

17   Exterior2nd     1. VinylSd       504 (34.5%)          IIIIII                1460       0        
     [character]     2. MetalSd       214 (14.7%)          II                    (100.0%)   (0.0%)   
                     3. HdBoard       207 (14.2%)          II                                        
                     4. Wd Sdng       197 (13.5%)          II                                        
                     5. Plywood       142 ( 9.7%)          I                                         
                     6. CmentBd        60 ( 4.1%)                                                    
                     7. Wd Shng        38 ( 2.6%)                                                    
                     8. Stucco         26 ( 1.8%)                                                    
                     9. BrkFace        25 ( 1.7%)                                                    
                     10. AsbShng       20 ( 1.4%)                                                    
                     [ 6 others ]      27 ( 1.8%)                                                    

18   MasVnrType      1. BrkCmn         15 ( 1.0%)                                1452       8        
     [character]     2. BrkFace       445 (30.6%)          IIIIII                (99.5%)    (0.5%)   
                     3. None          864 (59.5%)          IIIIIIIIIII                               
                     4. Stone         128 ( 8.8%)          I                                         

19   ExterQual       1. Ex             52 ( 3.6%)                                1460       0        
     [character]     2. Fa             14 ( 1.0%)                                (100.0%)   (0.0%)   
                     3. Gd            488 (33.4%)          IIIIII                                    
                     4. TA            906 (62.1%)          IIIIIIIIIIII                              

20   ExterCond       1. Ex               3 ( 0.2%)                               1460       0        
     [character]     2. Fa              28 ( 1.9%)                               (100.0%)   (0.0%)   
                     3. Gd             146 (10.0%)         II                                        
                     4. Po               1 ( 0.1%)                                                   
                     5. TA            1282 (87.8%)         IIIIIIIIIIIIIIIII                         

21   Foundation      1. BrkTil        146 (10.0%)          II                    1460       0        
     [character]     2. CBlock        634 (43.4%)          IIIIIIII              (100.0%)   (0.0%)   
                     3. PConc         647 (44.3%)          IIIIIIII                                  
                     4. Slab           24 ( 1.6%)                                                    
                     5. Stone           6 ( 0.4%)                                                    
                     6. Wood            3 ( 0.2%)                                                    

22   BsmtQual        1. Ex            121 ( 8.5%)          I                     1423       37       
     [character]     2. Fa             35 ( 2.5%)                                (97.5%)    (2.5%)   
                     3. Gd            618 (43.4%)          IIIIIIII                                  
                     4. TA            649 (45.6%)          IIIIIIIII                                 

23   BsmtCond        1. Fa              45 ( 3.2%)                               1423       37       
     [character]     2. Gd              65 ( 4.6%)                               (97.5%)    (2.5%)   
                     3. Po               2 ( 0.1%)                                                   
                     4. TA            1311 (92.1%)         IIIIIIIIIIIIIIIIII                        

24   BsmtExposure    1. Av            221 (15.5%)          III                   1422       38       
     [character]     2. Gd            134 ( 9.4%)          I                     (97.4%)    (2.6%)   
                     3. Mn            114 ( 8.0%)          I                                         
                     4. No            953 (67.0%)          IIIIIIIIIIIII                             

25   BsmtFinType1    1. ALQ           220 (15.5%)          III                   1423       37       
     [character]     2. BLQ           148 (10.4%)          II                    (97.5%)    (2.5%)   
                     3. GLQ           418 (29.4%)          IIIII                                     
                     4. LwQ            74 ( 5.2%)          I                                         
                     5. Rec           133 ( 9.3%)          I                                         
                     6. Unf           430 (30.2%)          IIIIII                                    

26   BsmtFinType2    1. ALQ             19 ( 1.3%)                               1422       38       
     [character]     2. BLQ             33 ( 2.3%)                               (97.4%)    (2.6%)   
                     3. GLQ             14 ( 1.0%)                                                   
                     4. LwQ             46 ( 3.2%)                                                   
                     5. Rec             54 ( 3.8%)                                                   
                     6. Unf           1256 (88.3%)         IIIIIIIIIIIIIIIII                         

27   Heating         1. Floor            1 ( 0.1%)                               1460       0        
     [character]     2. GasA          1428 (97.8%)         IIIIIIIIIIIIIIIIIII   (100.0%)   (0.0%)   
                     3. GasW            18 ( 1.2%)                                                   
                     4. Grav             7 ( 0.5%)                                                   
                     5. OthW             2 ( 0.1%)                                                   
                     6. Wall             4 ( 0.3%)                                                   

28   HeatingQC       1. Ex            741 (50.8%)          IIIIIIIIII            1460       0        
     [character]     2. Fa             49 ( 3.4%)                                (100.0%)   (0.0%)   
                     3. Gd            241 (16.5%)          III                                       
                     4. Po              1 ( 0.1%)                                                    
                     5. TA            428 (29.3%)          IIIII                                     

29   CentralAir      1. N               95 ( 6.5%)         I                     1460       0        
     [character]     2. Y             1365 (93.5%)         IIIIIIIIIIIIIIIIII    (100.0%)   (0.0%)   

30   Electrical      1. FuseA           94 ( 6.4%)         I                     1459       1        
     [character]     2. FuseF           27 ( 1.9%)                               (99.9%)    (0.1%)   
                     3. FuseP            3 ( 0.2%)                                                   
                     4. Mix              1 ( 0.1%)                                                   
                     5. SBrkr         1334 (91.4%)         IIIIIIIIIIIIIIIIII                        

31   KitchenQual     1. Ex            100 ( 6.8%)          I                     1460       0        
     [character]     2. Fa             39 ( 2.7%)                                (100.0%)   (0.0%)   
                     3. Gd            586 (40.1%)          IIIIIIII                                  
                     4. TA            735 (50.3%)          IIIIIIIIII                                

32   Functional      1. Maj1            14 ( 1.0%)                               1460       0        
     [character]     2. Maj2             5 ( 0.3%)                               (100.0%)   (0.0%)   
                     3. Min1            31 ( 2.1%)                                                   
                     4. Min2            34 ( 2.3%)                                                   
                     5. Mod             15 ( 1.0%)                                                   
                     6. Sev              1 ( 0.1%)                                                   
                     7. Typ           1360 (93.2%)         IIIIIIIIIIIIIIIIII                        

33   FireplaceQu     1. Ex             24 ( 3.1%)                                770        690      
     [character]     2. Fa             33 ( 4.3%)                                (52.7%)    (47.3%)  
                     3. Gd            380 (49.4%)          IIIIIIIII                                 
                     4. Po             20 ( 2.6%)                                                    
                     5. TA            313 (40.6%)          IIIIIIII                                  

34   GarageType      1. 2Types          6 ( 0.4%)                                1379       81       
     [character]     2. Attchd        870 (63.1%)          IIIIIIIIIIII          (94.5%)    (5.5%)   
                     3. Basment        19 ( 1.4%)                                                    
                     4. BuiltIn        88 ( 6.4%)          I                                         
                     5. CarPort         9 ( 0.7%)                                                    
                     6. Detchd        387 (28.1%)          IIIII                                     

35   GarageFinish    1. Fin           352 (25.5%)          IIIII                 1379       81       
     [character]     2. RFn           422 (30.6%)          IIIIII                (94.5%)    (5.5%)   
                     3. Unf           605 (43.9%)          IIIIIIII                                  

36   GarageQual      1. Ex               3 ( 0.2%)                               1379       81       
     [character]     2. Fa              48 ( 3.5%)                               (94.5%)    (5.5%)   
                     3. Gd              14 ( 1.0%)                                                   
                     4. Po               3 ( 0.2%)                                                   
                     5. TA            1311 (95.1%)         IIIIIIIIIIIIIIIIIII                       

37   GarageCond      1. Ex               2 ( 0.1%)                               1379       81       
     [character]     2. Fa              35 ( 2.5%)                               (94.5%)    (5.5%)   
                     3. Gd               9 ( 0.7%)                                                   
                     4. Po               7 ( 0.5%)                                                   
                     5. TA            1326 (96.2%)         IIIIIIIIIIIIIIIIIII                       

38   PavedDrive      1. N               90 ( 6.2%)         I                     1460       0        
     [character]     2. P               30 ( 2.1%)                               (100.0%)   (0.0%)   
                     3. Y             1340 (91.8%)         IIIIIIIIIIIIIIIIII                        

39   PoolQC          1. Ex            2 (28.6%)            IIIII                 7          1453     
     [character]     2. Fa            2 (28.6%)            IIIII                 (0.5%)     (99.5%)  
                     3. Gd            3 (42.9%)            IIIIIIII                                  

40   Fence           1. GdPrv          59 (21.0%)          IIII                  281        1179     
     [character]     2. GdWo           54 (19.2%)          III                   (19.2%)    (80.8%)  
                     3. MnPrv         157 (55.9%)          IIIIIIIIIII                               
                     4. MnWw           11 ( 3.9%)                                                    

41   MiscFeature     1. Gar2           2 ( 3.7%)                                 54         1406     
     [character]     2. Othr           2 ( 3.7%)                                 (3.7%)     (96.3%)  
                     3. Shed          49 (90.7%)           IIIIIIIIIIIIIIIIII                        
                     4. TenC           1 ( 1.9%)                                                     

42   SaleType        1. COD             43 ( 2.9%)                               1460       0        
     [character]     2. Con              2 ( 0.1%)                               (100.0%)   (0.0%)   
                     3. ConLD            9 ( 0.6%)                                                   
                     4. ConLI            5 ( 0.3%)                                                   
                     5. ConLw            5 ( 0.3%)                                                   
                     6. CWD              4 ( 0.3%)                                                   
                     7. New            122 ( 8.4%)         I                                         
                     8. Oth              3 ( 0.2%)                                                   
                     9. WD            1267 (86.8%)         IIIIIIIIIIIIIIIII                         

43   SaleCondition   1. Abnorml        101 ( 6.9%)         I                     1460       0        
     [character]     2. AdjLand          4 ( 0.3%)                               (100.0%)   (0.0%)   
                     3. Alloca          12 ( 0.8%)                                                   
                     4. Family          20 ( 1.4%)                                                   
                     5. Normal        1198 (82.1%)         IIIIIIIIIIIIIIII                          
                     6. Partial        125 ( 8.6%)         I                                         

44   MSSubClass      1. 20            536 (36.7%)          IIIIIII               1460       0        
     [character]     2. 60            299 (20.5%)          IIII                  (100.0%)   (0.0%)   
                     3. 50            144 ( 9.9%)          I                                         
                     4. 120            87 ( 6.0%)          I                                         
                     5. 30             69 ( 4.7%)                                                    
                     6. 160            63 ( 4.3%)                                                    
                     7. 70             60 ( 4.1%)                                                    
                     8. 80             58 ( 4.0%)                                                    
                     9. 90             52 ( 3.6%)                                                    
                     10. 190           30 ( 2.1%)                                                    
                     [ 5 others ]      62 ( 4.2%)                                                    
-----------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="explore-the-continues-variables" class="level3">
<h3 class="anchored" data-anchor-id="explore-the-continues-variables">2.2. Explore the continues variables</h3>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-9_c8b7ce7d5b7d7d635ed609c813aec8f8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>stat_cont <span class="ot">&lt;-</span> <span class="fu">summary</span>(train[, <span class="fu">sapply</span>(train, is.numeric)])</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>stat_cont</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  LotFrontage        LotArea        OverallQual      OverallCond   
 Min.   : 21.00   Min.   :  1300   Min.   : 1.000   Min.   :1.000  
 1st Qu.: 59.00   1st Qu.:  7554   1st Qu.: 5.000   1st Qu.:5.000  
 Median : 69.00   Median :  9478   Median : 6.000   Median :5.000  
 Mean   : 70.05   Mean   : 10517   Mean   : 6.099   Mean   :5.575  
 3rd Qu.: 80.00   3rd Qu.: 11602   3rd Qu.: 7.000   3rd Qu.:6.000  
 Max.   :313.00   Max.   :215245   Max.   :10.000   Max.   :9.000  
 NA's   :259                                                       
   YearBuilt     YearRemodAdd    MasVnrArea       BsmtFinSF1    
 Min.   :1872   Min.   :1950   Min.   :   0.0   Min.   :   0.0  
 1st Qu.:1954   1st Qu.:1967   1st Qu.:   0.0   1st Qu.:   0.0  
 Median :1973   Median :1994   Median :   0.0   Median : 383.5  
 Mean   :1971   Mean   :1985   Mean   : 103.7   Mean   : 443.6  
 3rd Qu.:2000   3rd Qu.:2004   3rd Qu.: 166.0   3rd Qu.: 712.2  
 Max.   :2010   Max.   :2010   Max.   :1600.0   Max.   :5644.0  
                               NA's   :8                        
   BsmtFinSF2        BsmtUnfSF       TotalBsmtSF       X1stFlrSF   
 Min.   :   0.00   Min.   :   0.0   Min.   :   0.0   Min.   : 334  
 1st Qu.:   0.00   1st Qu.: 223.0   1st Qu.: 795.8   1st Qu.: 882  
 Median :   0.00   Median : 477.5   Median : 991.5   Median :1087  
 Mean   :  46.55   Mean   : 567.2   Mean   :1057.4   Mean   :1163  
 3rd Qu.:   0.00   3rd Qu.: 808.0   3rd Qu.:1298.2   3rd Qu.:1391  
 Max.   :1474.00   Max.   :2336.0   Max.   :6110.0   Max.   :4692  
                                                                   
   X2ndFlrSF     LowQualFinSF       GrLivArea     BsmtFullBath   
 Min.   :   0   Min.   :  0.000   Min.   : 334   Min.   :0.0000  
 1st Qu.:   0   1st Qu.:  0.000   1st Qu.:1130   1st Qu.:0.0000  
 Median :   0   Median :  0.000   Median :1464   Median :0.0000  
 Mean   : 347   Mean   :  5.845   Mean   :1515   Mean   :0.4253  
 3rd Qu.: 728   3rd Qu.:  0.000   3rd Qu.:1777   3rd Qu.:1.0000  
 Max.   :2065   Max.   :572.000   Max.   :5642   Max.   :3.0000  
                                                                 
  BsmtHalfBath        FullBath        HalfBath       BedroomAbvGr  
 Min.   :0.00000   Min.   :0.000   Min.   :0.0000   Min.   :0.000  
 1st Qu.:0.00000   1st Qu.:1.000   1st Qu.:0.0000   1st Qu.:2.000  
 Median :0.00000   Median :2.000   Median :0.0000   Median :3.000  
 Mean   :0.05753   Mean   :1.565   Mean   :0.3829   Mean   :2.866  
 3rd Qu.:0.00000   3rd Qu.:2.000   3rd Qu.:1.0000   3rd Qu.:3.000  
 Max.   :2.00000   Max.   :3.000   Max.   :2.0000   Max.   :8.000  
                                                                   
  KitchenAbvGr    TotRmsAbvGrd      Fireplaces     GarageYrBlt  
 Min.   :0.000   Min.   : 2.000   Min.   :0.000   Min.   :1900  
 1st Qu.:1.000   1st Qu.: 5.000   1st Qu.:0.000   1st Qu.:1961  
 Median :1.000   Median : 6.000   Median :1.000   Median :1980  
 Mean   :1.047   Mean   : 6.518   Mean   :0.613   Mean   :1979  
 3rd Qu.:1.000   3rd Qu.: 7.000   3rd Qu.:1.000   3rd Qu.:2002  
 Max.   :3.000   Max.   :14.000   Max.   :3.000   Max.   :2010  
                                                  NA's   :81    
   GarageCars      GarageArea       WoodDeckSF      OpenPorchSF    
 Min.   :0.000   Min.   :   0.0   Min.   :  0.00   Min.   :  0.00  
 1st Qu.:1.000   1st Qu.: 334.5   1st Qu.:  0.00   1st Qu.:  0.00  
 Median :2.000   Median : 480.0   Median :  0.00   Median : 25.00  
 Mean   :1.767   Mean   : 473.0   Mean   : 94.24   Mean   : 46.66  
 3rd Qu.:2.000   3rd Qu.: 576.0   3rd Qu.:168.00   3rd Qu.: 68.00  
 Max.   :4.000   Max.   :1418.0   Max.   :857.00   Max.   :547.00  
                                                                   
 EnclosedPorch      X3SsnPorch      ScreenPorch        PoolArea      
 Min.   :  0.00   Min.   :  0.00   Min.   :  0.00   Min.   :  0.000  
 1st Qu.:  0.00   1st Qu.:  0.00   1st Qu.:  0.00   1st Qu.:  0.000  
 Median :  0.00   Median :  0.00   Median :  0.00   Median :  0.000  
 Mean   : 21.95   Mean   :  3.41   Mean   : 15.06   Mean   :  2.759  
 3rd Qu.:  0.00   3rd Qu.:  0.00   3rd Qu.:  0.00   3rd Qu.:  0.000  
 Max.   :552.00   Max.   :508.00   Max.   :480.00   Max.   :738.000  
                                                                     
    MiscVal             MoSold           YrSold       SalePrice     
 Min.   :    0.00   Min.   : 1.000   Min.   :2006   Min.   : 34900  
 1st Qu.:    0.00   1st Qu.: 5.000   1st Qu.:2007   1st Qu.:129975  
 Median :    0.00   Median : 6.000   Median :2008   Median :163000  
 Mean   :   43.49   Mean   : 6.322   Mean   :2008   Mean   :180921  
 3rd Qu.:    0.00   3rd Qu.: 8.000   3rd Qu.:2009   3rd Qu.:214000  
 Max.   :15500.00   Max.   :12.000   Max.   :2010   Max.   :755000  
                                                                    </code></pre>
</div>
</div>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-10_67ae8d3785f5369d5349a4a95bddf69d">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>tr_cont <span class="ot">&lt;-</span> train[, <span class="sc">!</span><span class="fu">sapply</span>(train, is.character)]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tr_cont)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  LotFrontage LotArea OverallQual OverallCond YearBuilt YearRemodAdd MasVnrArea
1          65    8450           7           5      2003         2003        196
2          80    9600           6           8      1976         1976          0
3          68   11250           7           5      2001         2002        162
4          60    9550           7           5      1915         1970          0
5          84   14260           8           5      2000         2000        350
6          85   14115           5           5      1993         1995          0
  BsmtFinSF1 BsmtFinSF2 BsmtUnfSF TotalBsmtSF X1stFlrSF X2ndFlrSF LowQualFinSF
1        706          0       150         856       856       854            0
2        978          0       284        1262      1262         0            0
3        486          0       434         920       920       866            0
4        216          0       540         756       961       756            0
5        655          0       490        1145      1145      1053            0
6        732          0        64         796       796       566            0
  GrLivArea BsmtFullBath BsmtHalfBath FullBath HalfBath BedroomAbvGr
1      1710            1            0        2        1            3
2      1262            0            1        2        0            3
3      1786            1            0        2        1            3
4      1717            1            0        1        0            3
5      2198            1            0        2        1            4
6      1362            1            0        1        1            1
  KitchenAbvGr TotRmsAbvGrd Fireplaces GarageYrBlt GarageCars GarageArea
1            1            8          0        2003          2        548
2            1            6          1        1976          2        460
3            1            6          1        2001          2        608
4            1            7          1        1998          3        642
5            1            9          1        2000          3        836
6            1            5          0        1993          2        480
  WoodDeckSF OpenPorchSF EnclosedPorch X3SsnPorch ScreenPorch PoolArea MiscVal
1          0          61             0          0           0        0       0
2        298           0             0          0           0        0       0
3          0          42             0          0           0        0       0
4          0          35           272          0           0        0       0
5        192          84             0          0           0        0       0
6         40          30             0        320           0        0     700
  MoSold YrSold SalePrice
1      2   2008    208500
2      5   2007    181500
3      9   2008    223500
4      2   2006    140000
5     12   2008    250000
6     10   2009    143000</code></pre>
</div>
</div>
<p><strong>Plotting heatmap for visualizing correlation:</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-11_85d5d95427d0cf91612472eab0950ed3">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>corr <span class="ot">&lt;-</span> <span class="fu">cor</span>(tr_cont)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>melted_corr <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(corr))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(melted_corr) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Var1"</span>, <span class="st">"Var2"</span>, <span class="st">"value"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Increase the plot size</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.width =</span> <span class="dv">30</span>, <span class="at">repr.plot.height =</span> <span class="dv">30</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(melted_corr, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span>  <span class="co"># Set the tile border color to white</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"red"</span>, <span class="at">high =</span> <span class="st">"yellow"</span>) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Correlation Heatmap"</span>) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>),  <span class="co"># Rotate x-axis labels</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())  <span class="co"># Remove grid lines</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Histograms for continues variables:</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-12_1efab358fd2962e8c4a6173f94e9aa97">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Select continuous features to plot</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">names</span>(tr_cont)[<span class="sc">!</span>(<span class="fu">names</span>(tr_cont) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Id"</span>, <span class="st">"OverallQual"</span>, <span class="st">"OverallCond"</span>, <span class="st">"YearBuilt"</span>, <span class="st">"YearRemodAdd"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"BsmtFullBath"</span>, <span class="st">"BsmtHalfBath"</span>, <span class="st">"FullBath"</span>, <span class="st">"HalfBath"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"BedroomAbvGr"</span>, <span class="st">"KitchenAbvGr"</span>, <span class="st">"TotRmsAbvGrd"</span>, <span class="st">"Fireplaces"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"GarageYrBlt"</span>, <span class="st">"GarageCars"</span>, <span class="st">"MoSold"</span>, <span class="st">"YrSold"</span>, <span class="st">"SalePrice"</span>))]</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(features)) {</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(tr_cont[[features[i]]], <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Histogram for"</span>, features[i]), <span class="at">xlab =</span> features[i], <span class="at">col =</span><span class="st">"lightblue"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-14.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-15.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-16.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-17.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-18.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-12-19.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="missing-values" class="level3">
<h3 class="anchored" data-anchor-id="missing-values">2.3. Missing values</h3>
<p>Check the missing values for train dataset:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-13_ee022c07b8a9e7373dbfef96a7ebbc44">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(train))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">&lt;-</span> missing_values[<span class="fu">order</span>(<span class="sc">-</span>missing_values)]</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Display the top 20 variables with the highest number of missing values</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-14_58d58943efa0d0ddb25bb68da27a9e28">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(missing_values, <span class="dv">20</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      PoolQC  MiscFeature        Alley        Fence  FireplaceQu  LotFrontage 
        1453         1406         1369         1179          690          259 
  GarageType  GarageYrBlt GarageFinish   GarageQual   GarageCond BsmtExposure 
          81           81           81           81           81           38 
BsmtFinType2     BsmtQual     BsmtCond BsmtFinType1   MasVnrType   MasVnrArea 
          38           37           37           37            8            8 
  Electrical   MSSubClass 
           1            0 </code></pre>
</div>
</div>
<p>Check the missing values for test dataset:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-15_d51a0df0e28e74ee27b860e496b12c37">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(test))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>missing_values <span class="ot">&lt;-</span> missing_values[<span class="fu">order</span>(<span class="sc">-</span>missing_values)]</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Display the top 35 variables with the highest number of missing values</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-16_97778df627b9ceaf84fbfab032586f1a">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(missing_values, <span class="dv">35</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      PoolQC  MiscFeature        Alley        Fence  FireplaceQu  LotFrontage 
        1456         1408         1352         1169          730          227 
 GarageYrBlt GarageFinish   GarageQual   GarageCond   GarageType     BsmtCond 
          78           78           78           78           76           45 
    BsmtQual BsmtExposure BsmtFinType1 BsmtFinType2   MasVnrType   MasVnrArea 
          44           44           42           42           16           15 
    MSZoning    Utilities BsmtFullBath BsmtHalfBath   Functional  Exterior1st 
           4            2            2            2            2            1 
 Exterior2nd   BsmtFinSF1   BsmtFinSF2    BsmtUnfSF  TotalBsmtSF  KitchenQual 
           1            1            1            1            1            1 
  GarageCars   GarageArea     SaleType   MSSubClass      LotArea 
           1            1            1            0            0 </code></pre>
</div>
</div>
<p><strong><em>Note:</em></strong> For both dataset some variables have a lot missing values: PoolQC, MiscFeature, Alley, Fence, FireplaceQu, LotFrontage</p>
<p>Drop the PoolQC column from the train dataset</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-17_bc44e7847685998529a2c29c286f12f1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> train[, <span class="sc">!</span>(<span class="fu">colnames</span>(train) <span class="sc">%in%</span> <span class="st">"PoolQC"</span>)]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Drop the PoolQC column from the test dataset:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-18_cc728b96f5a30c5dfc658a182cd7b6d6">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> test[, <span class="sc">!</span>(<span class="fu">colnames</span>(test) <span class="sc">%in%</span> <span class="st">"PoolQC"</span>)]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Fill the missing variables for the categorical variables:</strong></p>
<p>Define the features with missing values:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-19_f27cc0aa9c9fef07daedcb99222f43de">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>obj_NA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Alley"</span>, <span class="st">"BsmtQual"</span>, <span class="st">"BsmtCond"</span>, <span class="st">"BsmtExposure"</span>, <span class="st">"BsmtFinType1"</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="st">"BsmtFinType2"</span>, <span class="st">"FireplaceQu"</span>, <span class="st">"GarageType"</span>, <span class="st">"GarageFinish"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="st">"GarageQual"</span>, <span class="st">"GarageCond"</span>, <span class="st">"Fence"</span>, <span class="st">"MiscFeature"</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fill in missing values with NA for the specified features in the train dataset</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-20_509006b9df811750e26b5871d0535af1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> obj_NA) {</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>train[, i][<span class="fu">is.na</span>(train[, i])] <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fill in missing values with NA for the specified features in the test dataset:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-21_7aaf89031511f26729935cad4e9444d6">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> obj_NA) {</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>test[, i][<span class="fu">is.na</span>(test[, i])] <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fill in missing values for the MSZoning, MasVnrType, Electrical, KitchenQual, Functional and SaleType:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-22_de0d0bf2e62033540100c2fe0166315f">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>obj_mode <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"MSZoning"</span>, <span class="st">"MasVnrType"</span>, <span class="st">"Electrical"</span>, <span class="st">"KitchenQual"</span>, <span class="st">"Functional"</span>, <span class="st">"SaleType"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>MSZoning[train<span class="sc">$</span>MSZoning <span class="sc">==</span> <span class="st">"C (all)"</span>] <span class="ot">&lt;-</span> <span class="st">"C"</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>MSZoning[test<span class="sc">$</span>MSZoning <span class="sc">==</span> <span class="st">"C (all)"</span>] <span class="ot">&lt;-</span> <span class="st">"C"</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-23_0447fbd666e9715948ab84bc0b4063d2">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> obj_mode) {</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  train[[i]][<span class="fu">is.na</span>(train[[i]])] <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(train[[i]])))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  test[[i]][<span class="fu">is.na</span>(test[[i]])] <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(test[[i]])))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fill in missing values for the Utilities feature</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-24_5ec51fa796d9fdfe6a7359f52482396e">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>Utilities[<span class="fu">is.na</span>(test<span class="sc">$</span>Utilities)] <span class="ot">&lt;-</span> <span class="st">"NoSeWa"</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fill in missing values for the Exterior1st feature</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-25_0ceb0e36c194fe4589d9a0239bf5649a">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>Exterior1st[<span class="fu">is.na</span>(test<span class="sc">$</span>Exterior1st)] <span class="ot">&lt;-</span> <span class="st">"ImStucc"</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fill in missing values for the Exterior2nd feature</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-26_82c510af7794a50959a996f704aa409c">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>Exterior2nd[<span class="fu">is.na</span>(test<span class="sc">$</span>Exterior2nd)] <span class="ot">&lt;-</span> <span class="st">"Other"</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Clean continues variables:</strong></p>
<p>Fill missing variables</p>
<p>Fill in missing values for the LotFrontage and MasVnrArea features</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-27_c6fff487da14fda094ab14e512e0ef40">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>obj_median <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"LotFrontage"</span>, <span class="st">"MasVnrArea"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> obj_median) {</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  train[[i]] <span class="ot">&lt;-</span> <span class="fu">na.aggregate</span>(train[[i]], <span class="at">FUN =</span> median)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  test[[i]] <span class="ot">&lt;-</span> <span class="fu">na.aggregate</span>(test[[i]], <span class="at">FUN =</span> median)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fill in missing values for the BsmtFinSF1, BsmtFinSF2, BsmtUnfSF, TotalBsmtSF, BsmtFullBath, BsmtHalfBath, GarageCars and GarageArea features</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-28_13cdc29702a3019f6c8401a259ffdc59">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>Mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  ux <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  ux[<span class="fu">which.max</span>(<span class="fu">tabulate</span>(<span class="fu">match</span>(x, ux)))]</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>obj_mode <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BsmtFinSF1"</span>, <span class="st">"BsmtFinSF2"</span>, <span class="st">"BsmtUnfSF"</span>, <span class="st">"TotalBsmtSF"</span>, <span class="st">"BsmtFullBath"</span>, <span class="st">"BsmtHalfBath"</span>, <span class="st">"GarageCars"</span>, <span class="st">"GarageArea"</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> obj_mode) {</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  test[[i]] <span class="ot">&lt;-</span> <span class="fu">replace</span>(test[[i]], <span class="fu">is.na</span>(test[[i]]), <span class="fu">Mode</span>(test[[i]]))</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fill in missing values for the GarageYrBlt feature</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-29_c8edece0dd637cb1526561691afebf9b">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>GarageYrBlt <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(train<span class="sc">$</span>GarageYrBlt), train<span class="sc">$</span>YearBuilt, train<span class="sc">$</span>GarageYrBlt)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>test<span class="sc">$</span>GarageYrBlt <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(test<span class="sc">$</span>GarageYrBlt), test<span class="sc">$</span>YearBuilt, test<span class="sc">$</span>GarageYrBlt)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Converting dtype to int64:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-30_57b5f2f3980790f20f1278bc4c1ca2d7">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>int_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"LotFrontage"</span>, <span class="st">"BsmtFinSF1"</span>, <span class="st">"BsmtFinSF2"</span>, <span class="st">"BsmtUnfSF"</span>, <span class="st">"TotalBsmtSF"</span>, <span class="st">"BsmtFullBath"</span>, <span class="st">"BsmtHalfBath"</span>, <span class="st">"GarageYrBlt"</span>, <span class="st">"GarageCars"</span>, <span class="st">"GarageArea"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> int_list) {</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  train[[i]] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(train[[i]])</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  test[[i]] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(test[[i]])</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>check the shape of dataset:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-31_334a54ecdce47c39aba08f129a817d59">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(train)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1460   79</code></pre>
</div>
</div>
</section>
<section id="feature-selection" class="level3">
<h3 class="anchored" data-anchor-id="feature-selection">2.4. Feature Selection</h3>
<section id="correlation-analysis" class="level4">
<h4 class="anchored" data-anchor-id="correlation-analysis">Correlation Analysis</h4>
<p>Filter numeric variables</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-32_f8d15e64602db48e339023a839abe2e6">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>numeric_vars <span class="ot">&lt;-</span> <span class="fu">sapply</span>(train, is.numeric)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation matrix</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>correlations <span class="ot">&lt;-</span> <span class="fu">cor</span>(train[, numeric_vars])</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort correlations with 'SalePrice'</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>sorted_correlations <span class="ot">&lt;-</span> <span class="fu">sort</span>(correlations[,<span class="st">"SalePrice"</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Display the most positive correlations:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-33_49dc58b226d31581d80539be4faa1a3c">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Most Positive Correlations:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">tail</span>(sorted_correlations, <span class="dv">10</span>))</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Most Positive Correlations:
       MoSold    X3SsnPorch    BsmtFinSF2  BsmtHalfBath       MiscVal 
   0.04643225    0.04458367   -0.01137812   -0.01684415   -0.02118958 
 LowQualFinSF        YrSold   OverallCond EnclosedPorch  KitchenAbvGr 
  -0.02560613   -0.02892259   -0.07785589   -0.12857796   -0.13590737 </code></pre>
</div>
</div>
<p>Display the most negative correlations:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-34_ef68f8c67a0c2eba0f2eb469abafc862">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Most Negative Correlations:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(sorted_correlations, <span class="dv">10</span>))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Most Negative Correlations:
   SalePrice  OverallQual    GrLivArea   GarageCars   GarageArea  TotalBsmtSF 
   1.0000000    0.7909816    0.7086245    0.6404092    0.6234314    0.6135806 
   X1stFlrSF     FullBath TotRmsAbvGrd    YearBuilt 
   0.6058522    0.5606638    0.5337232    0.5228973 </code></pre>
</div>
</div>
<p><strong>Area vs Sale Price</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-35_81d96dee83fe8e13b53568675926c51d">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>)) <span class="co"># Set the layout of subplots</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"LotArea"</span>,<span class="st">"MasVnrArea"</span>,<span class="st">"BsmtFinSF1"</span>,<span class="st">"BsmtFinSF2"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"BsmtUnfSF"</span>,<span class="st">"TotalBsmtSF"</span>,<span class="st">"X1stFlrSF"</span>,<span class="st">"X2ndFlrSF"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"LowQualFinSF"</span>,<span class="st">"GrLivArea"</span>,<span class="st">"GarageArea"</span>,<span class="st">"WoodDeckSF"</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"OpenPorchSF"</span>,<span class="st">"EnclosedPorch"</span>,<span class="st">"X3SsnPorch"</span>,<span class="st">"ScreenPorch"</span>,<span class="st">"PoolArea"</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>desc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Lot Size"</span>,<span class="st">"Masonry Seneer Area"</span>,<span class="st">"Basement Type 1 Finished"</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Basement Type 2 Finished"</span>,<span class="st">"Unfinished Basement Area"</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Total Basement Area"</span>,<span class="st">"First Floor"</span>,<span class="st">"Second Floor"</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Low Quality Finished"</span>,<span class="st">"Above Grade Living Area"</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Size of Garage"</span>,<span class="st">"Wood Deck Area"</span>,<span class="st">"Open Porch Area"</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Enclosed Porch Area"</span>,<span class="st">"Three Season Porch Area"</span>,<span class="st">"Screen Porch Area"</span>,<span class="st">"Pool Area"</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(labels)) {</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">&lt;=</span> <span class="dv">17</span>) {</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(train[[labels[i]]], train[[<span class="st">"SalePrice"</span>]],</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> desc[i], <span class="at">ylab =</span> <span class="st">"Sale Price"</span>,</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> desc[i], <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It is clearly seen that there is positive correlation between price and areas i.e.&nbsp;if the area increases price will also increases expect 3SsnPorch (three season porch) and PoolArea.</p>
<p><strong>Neighborhood vs Sale Price</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-36_2303cd48300ca70dcc12e05ac4e7f1fa">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(train, <span class="fu">aes</span>(<span class="at">x =</span> Neighborhood, <span class="at">y =</span> SalePrice)) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Sale Price"</span>) <span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Neighborhood"</span>) <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note: We can see that the prices of the house having NoRidge, NridgHt, StoneBr and Timber neighborhoods are very high.</p>
<p><strong>Building type, House Style</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-37_c2eb8789029f52c2ca63f6a7cc019f36">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BldgType"</span>, <span class="st">"HouseStyle"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(train, <span class="fu">aes</span>(<span class="at">x =</span> train[[labels[<span class="dv">1</span>]]], <span class="at">y =</span> train[[<span class="st">"SalePrice"</span>]])) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(labels[<span class="dv">1</span>])</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> plt <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> train[[labels[<span class="dv">2</span>]]], <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> plt <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plt)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>House Quality</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-38_76bdc7503363745f8b7e5defbaf1096c">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"OverallQual"</span>, <span class="st">"ExterQual"</span>, <span class="st">"BsmtQual"</span>, <span class="st">"HeatingQC"</span>, <span class="st">"KitchenQual"</span>, <span class="st">"FireplaceQu"</span>, <span class="st">"GarageQual"</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> labels) {</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (col <span class="sc">&lt;</span> <span class="dv">9</span>) {</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    plot_col <span class="ot">&lt;-</span> col <span class="sc">%%</span> <span class="dv">4</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (plot_col <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>      plot_col <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    plot_row <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(col <span class="sc">/</span> <span class="dv">4</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    plot_index <span class="ot">&lt;-</span> (plot_row <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">4</span> <span class="sc">+</span> plot_col</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">barplot</span>(<span class="fu">tapply</span>(train<span class="sc">$</span>SalePrice, train[, i], mean), <span class="at">xlab =</span> i, <span class="at">ylab =</span> <span class="st">"SalePrice"</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> i)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  col <span class="ot">&lt;-</span> col <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Note:</strong> It can be seen that there is positive relation between quality and price. Price increases according to the quality.</p>
<p><strong>House condition</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-39_7010dff6fbafeaca74e932d5c4271e48">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"OverallCond"</span>, <span class="st">"ExterCond"</span>, <span class="st">"BsmtCond"</span>, <span class="st">"GarageCond"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> labels) {</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (cols <span class="sc">&lt;</span> <span class="dv">5</span>) {</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    plt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(train, <span class="fu">aes</span>(<span class="at">x =</span> train[[i]], <span class="at">y =</span> train[[<span class="st">"SalePrice"</span>]])) <span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(i) <span class="sc">+</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    plots[[cols]] <span class="ot">&lt;-</span> plt</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  cols <span class="ot">&lt;-</span> cols <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plots, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">top =</span> <span class="st">"Subplots"</span>)</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Note:</strong> Prices of the house having Ex (excellent) and Gd (good) condition are very high.</p>
<p><strong>Bathroom condition</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-40_6e7878b406a848e11dd27eeda8d782ae">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom function to format labels in millions</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>formatMillions <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="fu">format</span>(x <span class="sc">/</span> <span class="fl">1e6</span>, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">""</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create individual bar plots</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(train, <span class="fu">aes</span>(<span class="at">x =</span> BsmtFullBath, <span class="at">y =</span> SalePrice)) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Sale Price (in million)"</span>) <span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"BsmtFullBath"</span>) <span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> formatMillions)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(train, <span class="fu">aes</span>(<span class="at">x =</span> BsmtHalfBath, <span class="at">y =</span> SalePrice)) <span class="sc">+</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Sale Price (in million)"</span>) <span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"BsmtHalfBath"</span>) <span class="sc">+</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> formatMillions)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(train, <span class="fu">aes</span>(<span class="at">x =</span> FullBath, <span class="at">y =</span> SalePrice)) <span class="sc">+</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Sale Price (in million)"</span>) <span class="sc">+</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"FullBath"</span>) <span class="sc">+</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> formatMillions)</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>plot4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(train, <span class="fu">aes</span>(<span class="at">x =</span> HalfBath, <span class="at">y =</span> SalePrice)) <span class="sc">+</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Sale Price (in million)"</span>) <span class="sc">+</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"HalfBath"</span>) <span class="sc">+</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> formatMillions)</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the plots in a grid</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, plot2, plot3, plot4, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Roof style and material</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-41_a1238f422ec564ba7276c0baa46e3539">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"RoofStyle"</span>, <span class="st">"RoofMatl"</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(labels)) {</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">&lt;=</span> <span class="dv">2</span>) {</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">barplot</span>(<span class="fu">tapply</span>(train<span class="sc">$</span>SalePrice, train[, labels[i]], mean), <span class="at">xlab =</span> labels[i], <span class="at">ylab =</span> <span class="st">"SalePrice"</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> labels[i])</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Basement</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-42_ee9a20fc903336fd2a0cc10f62d66639">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of labels</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BsmtExposure"</span>, <span class="st">"BsmtFinType1"</span>, <span class="st">"BsmtFinType2"</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list to store the plots</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through the labels and create bar plots</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(labels)) {</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(train, <span class="fu">aes_string</span>(<span class="at">x =</span> labels[i], <span class="at">y =</span> <span class="st">"SalePrice"</span>)) <span class="sc">+</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Sale Price"</span>) <span class="sc">+</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(labels[i]) <span class="sc">+</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>(<span class="at">scale =</span> <span class="fl">1e-6</span>, <span class="at">prefix =</span> <span class="st">"$"</span>))</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  plots[[i]] <span class="ot">&lt;-</span> plot</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the plots in a grid</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plots, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Garage</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-43_c57bdef39c5550a1a352fcaa8567ae45">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GarageType"</span>, <span class="st">"GarageFinish"</span>, <span class="st">"GarageCars"</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(labels)) {</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">&lt;=</span> <span class="dv">3</span>) {</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">barplot</span>(<span class="fu">tapply</span>(train<span class="sc">$</span>SalePrice, train[, labels[i]], mean), <span class="at">xlab =</span> labels[i], <span class="at">ylab =</span> <span class="st">"SalePrice"</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">title</span>(<span class="at">main =</span> labels[i])</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Month and Year of Sold</strong></p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-44_e8e9ce71048be414264207d94088c6f9">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>yearsold <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2006</span><span class="sc">:</span><span class="dv">2010</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>monthsold <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>, <span class="st">"June"</span>, <span class="st">"July"</span>, <span class="st">"August"</span>, <span class="st">"September"</span>, <span class="st">"October"</span>, <span class="st">"November"</span>, <span class="st">"December"</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">table</span>(train<span class="sc">$</span>YrSold)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>months <span class="ot">&lt;-</span> <span class="fu">table</span>(train<span class="sc">$</span>MoSold)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(years, <span class="at">labels =</span> yearsold, <span class="at">explode =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>), <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(yearsold)), <span class="at">main =</span> <span class="st">"Year Sold"</span>, <span class="at">cex.main =</span> <span class="fl">1.2</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(months, <span class="at">labels =</span> monthsold, <span class="at">explode =</span> <span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="dv">12</span>), <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(monthsold)), <span class="at">main =</span> <span class="st">"Month Sold"</span>, <span class="at">cex.main =</span> <span class="fl">1.2</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Note:</strong> Maximum houses were sold in year 2009 and in month of June. We can also see a decline in sales from 2009 to 2010.</p>
</section>
</section>
<section id="transform-skewed-features" class="level3">
<h3 class="anchored" data-anchor-id="transform-skewed-features">2.5.Transform Skewed Features</h3>
<p>Plot histogram for each continuous feature to see if a transformation is necessary</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-45_b782b718000ae0fd2f0f71351ad43ef2">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">colnames</span>(train)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (feature <span class="cf">in</span> features) {</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">class</span>(train[[feature]]) <span class="sc">!=</span> <span class="st">"character"</span>) {</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>(feature <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"OverallQual"</span>, <span class="st">"OverallCond"</span>, <span class="st">"YearBuilt"</span>, <span class="st">"YearRemodAdd"</span>, <span class="st">"BsmtFullBath"</span>, <span class="st">"BsmtHalfBath"</span>, <span class="st">"FullBath"</span>, <span class="st">"HalfBath"</span>, <span class="st">"BedroomAbvGr"</span>, <span class="st">"KitchenAbvGr"</span>, <span class="st">"TotRmsAbvGrd"</span>, <span class="st">"Fireplaces"</span>, <span class="st">"GarageYrBlt"</span>, <span class="st">"GarageCars"</span>, <span class="st">"MoSold"</span>, <span class="st">"YrSold"</span>, <span class="st">"SalePrice"</span>))) {</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (col <span class="sc">&lt;</span> <span class="dv">21</span>) {</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">hist</span>(train[[feature]], <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Histogram for"</span>, feature), <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>      col <span class="ot">&lt;-</span> col <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Project_MAA_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Box-Cox Power Transformation:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-46_12f992ba504da13485bbdf9630aae6df">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>LotFrontage <span class="ot">&lt;-</span> train<span class="sc">$</span>LotFrontage<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>LotArea <span class="ot">&lt;-</span> train<span class="sc">$</span>LotArea<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>MasVnrArea <span class="ot">&lt;-</span> train<span class="sc">$</span>MasVnrArea<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">1.5</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>BsmtFinSF1 <span class="ot">&lt;-</span> train<span class="sc">$</span>BsmtFinSF1<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">1.4</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>BsmtUnfSF <span class="ot">&lt;-</span> train<span class="sc">$</span>BsmtUnfSF<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">1.5</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>TotalBsmtSF <span class="ot">&lt;-</span> train<span class="sc">$</span>TotalBsmtSF<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">1.4</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>X1stFlrSF <span class="ot">&lt;-</span> train<span class="sc">$</span>X1stFlrSF<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>GrLivArea <span class="ot">&lt;-</span> train<span class="sc">$</span>GrLivArea<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">4.5</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>GarageArea <span class="ot">&lt;-</span> train<span class="sc">$</span>GarageArea<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">1.1</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>WoodDeckSF <span class="ot">&lt;-</span> train<span class="sc">$</span>WoodDeckSF<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">1.2</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>OpenPorchSF <span class="ot">&lt;-</span> train<span class="sc">$</span>OpenPorchSF<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">2.5</span>)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="convert-categorical-features-to-numeric" class="level3">
<h3 class="anchored" data-anchor-id="convert-categorical-features-to-numeric">2.6.Convert Categorical Features To Numeric</h3>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-47_3cbe62f368eebd8c28d85a370798279b">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">colnames</span>(train)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (feature <span class="cf">in</span> features) {</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">class</span>(train[[feature]]) <span class="sc">==</span> <span class="st">"character"</span>) {</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    train[[feature]] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">factor</span>(train[[feature]]))</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    test[[feature]] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">factor</span>(test[[feature]]))</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="split-into-train-and-test-set" class="level2">
<h2 class="anchored" data-anchor-id="split-into-train-and-test-set">Split Into Train And Test Set</h2>
<p>Drop unnecessary features</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-48_2b17df70c0df1888e2e2e14ed5d43cef">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> train[, <span class="sc">!</span><span class="fu">colnames</span>(train) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SalePrice"</span>)]</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the target variable</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> train<span class="sc">$</span>SalePrice</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Set the seed for reproducibility</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-49_0ae123515b79d4075148b9e3ece601af">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="split-the-data-into-training-and-test-sets" class="level3">
<h3 class="anchored" data-anchor-id="split-the-data-into-training-and-test-sets">Split the data into training and test sets</h3>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-50_70b35390270ec735f71fc89842137e9a">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(train), <span class="at">size =</span> <span class="fu">round</span>(<span class="fl">0.8</span> <span class="sc">*</span> <span class="fu">nrow</span>(train)), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> X[train_indices, ]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> y[train_indices]</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> X[<span class="sc">-</span>train_indices, ]</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> y[<span class="sc">-</span>train_indices]</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="standardize-features" class="level3">
<h3 class="anchored" data-anchor-id="standardize-features">Standardize Features</h3>
<p>Fit the scaler on the training data</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-51_df2849124cce16eaeda06910c215d7f2">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>scaler <span class="ot">&lt;-</span> <span class="fu">scale</span>(X_train)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the scaler to the training data</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>X_train_scaled <span class="ot">&lt;-</span> scaler</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the scaler to the test data</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>X_test_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(X_test, <span class="at">center =</span> <span class="fu">attr</span>(scaler, <span class="st">"scaled:center"</span>), <span class="at">scale =</span> <span class="fu">attr</span>(scaler, <span class="st">"scaled:scale"</span>))</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculate the mean and standard deviation from the training set:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-52_b7c9083085c45f1801ffb07b8056321c">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>scale_params <span class="ot">&lt;-</span> <span class="fu">apply</span>(X_train, <span class="dv">2</span>, mean)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>scale_sd <span class="ot">&lt;-</span> <span class="fu">apply</span>(X_train, <span class="dv">2</span>, sd)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale the training set</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>X_train_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(X_train, <span class="at">center =</span> scale_params, <span class="at">scale =</span> scale_sd)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale the test set using the scaling parameters from the training set</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>X_test_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(X_test, <span class="at">center =</span> scale_params, <span class="at">scale =</span> scale_sd)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="models" class="level1">
<h1>MODELS</h1>
<p>Lets build initial functions for the models:</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-53_f4fbfb9ea564b20190a47b66d67794f5">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># build finction for loss function</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>rmse_cv <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="fu">mean</span>(<span class="fu">cross_val_score</span>(model, X, y, <span class="at">scoring =</span> <span class="st">"neg_mean_squared_error"</span>, <span class="at">cv =</span> <span class="dv">5</span>)))</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">round</span>(rmse, <span class="dv">4</span>))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>evaluation <span class="ot">&lt;-</span> <span class="cf">function</span>(y, predictions) {</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(y <span class="sc">-</span> predictions))</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((y <span class="sc">-</span> predictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  r_squared <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="fu">sum</span>((y <span class="sc">-</span> predictions)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mae =</span> <span class="fu">round</span>(mae, <span class="dv">4</span>), <span class="at">mse =</span> <span class="fu">round</span>(mse, <span class="dv">4</span>), <span class="at">rmse =</span> <span class="fu">round</span>(rmse, <span class="dv">4</span>), <span class="at">r_squared =</span> <span class="fu">round</span>(r_squared, <span class="dv">4</span>)))</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="fu">character</span>(),</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">MAE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">MSE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">RMSE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">R2_Score =</span> <span class="fu">numeric</span>(),</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">RMSE_CV =</span> <span class="fu">numeric</span>(),</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression">1. Linear Regression</h2>
<p>Well, firstly create linear regression model</p>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-54_0e3b3bb912a993e0d813aff82f205c42">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a linear regression model</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>lin_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_train <span class="sc">~</span> ., <span class="at">data =</span> X_train)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Make predictions on the test set</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>ln_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lin_reg, <span class="at">newdata =</span> X_test)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Evaluate the model</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(ln_predictions <span class="sc">-</span> y_test))</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((ln_predictions <span class="sc">-</span> y_test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">summary</span>(lin_reg)<span class="sc">$</span>r.squared</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="do">### Print the evaluation metrics</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"MAE:"</span>, mae))</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"MSE:"</span>, mse))</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE:"</span>, rmse))</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"R2 Score:"</span>, r_squared))</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Perform cross-validation and calculate RMSE</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>rmse_cross_val <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((<span class="fu">predict</span>(lin_reg, <span class="at">newdata =</span> X_train) <span class="sc">-</span> y_train)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a><span class="do">### Print the cross-validated RMSE</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE Cross-Validation:"</span>, rmse_cross_val))</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a data frame to store the model results</span></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="st">"LinearRegression"</span>,</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE =</span> mae,</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE =</span> mse,</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE =</span> rmse,</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_Score =</span> r_squared,</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_CV =</span> rmse_cross_val,</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>  <span class="co"># Add this line to prevent factors</span></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Match the column names</span></span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(new_row) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(models)</span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Append the new row to the existing data frame (models)</span></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">rbind</span>(models, new_row)</span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MAE: 20276.1649935041"
[1] "MSE: 1174531451.46711"
[1] "RMSE: 34271.4378377551"
[1] "R2 Score: 0.855246479023401"
[1] "RMSE Cross-Validation: 29897.7985479486"</code></pre>
</div>
</div>
</section>
<section id="decision-tree" class="level2">
<h2 class="anchored" data-anchor-id="decision-tree">2. Decision Tree</h2>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-55_d778fab4965c1cf631028e1624695f22">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Train the decision tree model</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>d_tree <span class="ot">&lt;-</span> <span class="fu">rpart</span>(y_train <span class="sc">~</span> ., <span class="at">data =</span> X_train)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Make predictions on the test set</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(d_tree, <span class="at">newdata =</span> X_test)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Evaluate the model</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> y_test))</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y_test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">cor</span>(predictions, y_test)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Print the MAE</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MAE:"</span>, mae, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Print the MSE</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MSE:"</span>, mse, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Print the RMSE</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE:"</span>, rmse, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Print the R2 Score</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R2 Score:"</span>, r_squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Perform cross-validation</span></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>cv_results <span class="ot">&lt;-</span> rpart<span class="sc">::</span><span class="fu">rpart.control</span>(<span class="at">cp =</span> <span class="fl">0.01</span>)  <span class="co"># Set the complexity parameter</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>cv_model <span class="ot">&lt;-</span> <span class="fu">rpart</span>(y_train <span class="sc">~</span> ., <span class="at">data =</span> X_train, <span class="at">control =</span> cv_results)</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>cv_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(cv_model, <span class="at">newdata =</span> X_train)</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>rmse_cross_val <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((cv_predictions <span class="sc">-</span> y_train)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Print the RMSE Cross-Validation</span></span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE Cross-Validation:"</span>, <span class="fu">round</span>(rmse_cross_val, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a new row for the model's results</span></span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="st">"DecisionTree"</span>,</span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAE =</span> mae,</span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">MSE =</span> mse,</span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE =</span> rmse,</span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_Score =</span> r_squared,</span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_CV =</span> rmse_cross_val,</span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span> </span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a><span class="do">## Match the column names</span></span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(new_row) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(models)</span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a><span class="do">## Append the new row to the existing models dataframe</span></span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">rbind</span>(models, new_row)</span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MAE: 28836.32 
MSE: 1722934536 
RMSE: 41508.25 
R2 Score: 0.7578854 
RMSE Cross-Validation: 38219.59 </code></pre>
</div>
</div>
</section>
<section id="random-forest" class="level2">
<h2 class="anchored" data-anchor-id="random-forest">3. Random Forest</h2>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-56_abc10db664066797b66e5666dd05bd54">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the cross-validation control</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the Random Forest model with cross-validation</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>random_forest <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="at">x =</span> X_train, <span class="at">y =</span> y_train, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">ntree =</span> <span class="dv">250</span>, <span class="at">trControl =</span> ctrl)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(random_forest, X_test)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>evaluation <span class="ot">&lt;-</span> <span class="fu">evaluation</span>(y_test, predictions)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the evaluation metrics</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"MAE:"</span>, <span class="fu">round</span>(evaluation<span class="sc">$</span>mae, <span class="dv">4</span>)))</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"MSE:"</span>, <span class="fu">round</span>(evaluation<span class="sc">$</span>mse, <span class="dv">4</span>)))</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE:"</span>, <span class="fu">round</span>(evaluation<span class="sc">$</span>rmse, <span class="dv">4</span>)))</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"R2 Score:"</span>, <span class="fu">round</span>(evaluation<span class="sc">$</span>r_squared, <span class="dv">4</span>)))</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate RMSE using cross-validation</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>rmse_cross_val <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(random_forest<span class="sc">$</span>results<span class="sc">$</span>RMSE)</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE Cross-Validation:"</span>, <span class="fu">round</span>(rmse_cross_val, <span class="dv">4</span>)))</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new row for the models dataframe</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="st">"RandomForest"</span>,</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">MAE =</span> evaluation<span class="sc">$</span>mae,</span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">MSE =</span> evaluation<span class="sc">$</span>mse,</span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">RMSE =</span> evaluation<span class="sc">$</span>rmse,</span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">R2_Score =</span> evaluation<span class="sc">$</span>r_squared,</span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>                      <span class="at">RMSE_CV =</span> rmse_cross_val)</span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Append the new row to the models dataframe</span></span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">rbind</span>(models, new_row)</span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MAE: 16487.9802"
[1] "MSE: 707359751.9236"
[1] "RMSE: 26596.2357"
[1] "R2 Score: 0.8962"
[1] "RMSE Cross-Validation: 186.4359" "RMSE Cross-Validation: 172.8728"
[3] "RMSE Cross-Validation: 174.381" </code></pre>
</div>
</div>
</section>
<section id="extreme-gradient-boosting-xgboost" class="level2">
<h2 class="anchored" data-anchor-id="extreme-gradient-boosting-xgboost">4. Extreme Gradient Boosting (XGBoost)</h2>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-57_899ac08d64560f27b08a8dd7c859834b">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the data to DMatrix format</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>dtrain <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(X_train), <span class="at">label =</span> y_train)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>dtest <span class="ot">&lt;-</span> <span class="fu">xgb.DMatrix</span>(<span class="at">data =</span> <span class="fu">as.matrix</span>(X_test))</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the parameters for the XGBoost model</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">objective =</span> <span class="st">"reg:squarederror"</span>,</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">eval_metric =</span> <span class="st">"rmse"</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the XGBoost model</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>Xg_boost <span class="ot">&lt;-</span> <span class="fu">xgb.train</span>(<span class="at">params =</span> params, <span class="at">data =</span> dtrain, <span class="at">nrounds =</span> <span class="dv">100</span>)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on the test set</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(Xg_boost, <span class="at">newdata =</span> dtest)</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate evaluation metrics</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> y_test))</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y_test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> mse <span class="sc">/</span> <span class="fu">var</span>(y_test)</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MAE:"</span>, mae, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MSE:"</span>, mse, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE:"</span>, rmse, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R2 Score:"</span>, r_squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation to calculate RMSE</span></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>cv_result <span class="ot">&lt;-</span> <span class="fu">xgb.cv</span>(<span class="at">params =</span> params, <span class="at">data =</span> dtrain, <span class="at">nfold =</span> <span class="dv">5</span>, <span class="at">nrounds =</span> <span class="dv">100</span>)</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>rmse_cross_val <span class="ot">&lt;-</span> <span class="fu">min</span>(cv_result<span class="sc">$</span>evaluation_log<span class="sc">$</span>test_rmse_mean)</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE Cross-Validation:"</span>, <span class="fu">round</span>(rmse_cross_val, <span class="dv">4</span>)))</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new row for the model results</span></span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="st">"XGradientBoosting"</span>,</span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a>                      <span class="at">MAE =</span> mae,</span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a>                      <span class="at">MSE =</span> mse,</span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a>                      <span class="at">RMSE =</span> rmse,</span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a>                      <span class="at">R2_Score =</span> r_squared,</span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a>                      <span class="at">RMSE_CV =</span> rmse_cross_val,</span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span> )</span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Append the new row to the models data frame</span></span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">rbind</span>(models, new_row)</span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MAE: 17603.54 
MSE: 1026421853 
RMSE: 32037.82 
R2 Score: 0.8499364 
[1] train-rmse:140888.796991+1657.542273    test-rmse:141246.172018+7693.047034 
[2] train-rmse:101737.350870+1249.323832    test-rmse:103783.928445+6767.418472 
[3] train-rmse:74111.894293+909.868698  test-rmse:77499.150973+6002.352619 
[4] train-rmse:54614.997015+764.273329  test-rmse:59552.955067+5409.323938 
[5] train-rmse:40857.821446+666.652290  test-rmse:48135.580786+5180.076146 
[6] train-rmse:31092.985909+630.329492  test-rmse:41122.743027+5190.850446 
[7] train-rmse:24151.716632+613.045868  test-rmse:36736.799798+4948.728045 
[8] train-rmse:19341.415041+554.145084  test-rmse:33978.241743+4623.212426 
[9] train-rmse:15992.774386+485.793152  test-rmse:32507.807566+4554.019498 
[10]    train-rmse:13644.310686+498.380756  test-rmse:31707.120232+4578.926761 
[11]    train-rmse:12008.379952+460.530640  test-rmse:31148.826960+4352.072782 
[12]    train-rmse:10897.381497+466.104011  test-rmse:30865.088023+4302.626399 
[13]    train-rmse:10077.923246+465.993540  test-rmse:30602.514310+4249.080192 
[14]    train-rmse:9496.632723+463.064796   test-rmse:30500.472443+4243.513973 
[15]    train-rmse:8981.556010+475.443393   test-rmse:30398.759423+4192.266592 
[16]    train-rmse:8509.639546+482.993614   test-rmse:30292.241056+4161.157670 
[17]    train-rmse:8152.953448+437.956874   test-rmse:30285.315962+4085.831241 
[18]    train-rmse:7890.481313+482.564636   test-rmse:30229.890361+4090.614030 
[19]    train-rmse:7628.414926+493.550703   test-rmse:30228.681782+4081.863035 
[20]    train-rmse:7322.594688+449.508214   test-rmse:30161.803780+4108.252914 
[21]    train-rmse:7119.502564+512.322026   test-rmse:30114.810066+4127.116779 
[22]    train-rmse:6948.799701+505.186440   test-rmse:30098.152727+4138.506371 
[23]    train-rmse:6772.286390+529.067291   test-rmse:30119.883356+4130.443038 
[24]    train-rmse:6563.689553+449.829972   test-rmse:30077.648100+4125.876869 
[25]    train-rmse:6373.326395+403.584943   test-rmse:30098.166051+4119.315820 
[26]    train-rmse:6203.723306+424.988961   test-rmse:30108.852660+4112.035544 
[27]    train-rmse:6017.891998+445.800261   test-rmse:30065.285113+4121.835054 
[28]    train-rmse:5768.993777+522.892538   test-rmse:30044.907651+4119.960242 
[29]    train-rmse:5475.956583+527.840888   test-rmse:30045.487757+4121.796867 
[30]    train-rmse:5263.813749+516.041308   test-rmse:30055.142833+4134.325625 
[31]    train-rmse:5065.366786+469.484236   test-rmse:30059.959975+4135.906142 
[32]    train-rmse:4960.801679+434.565432   test-rmse:30030.725550+4135.841640 
[33]    train-rmse:4795.478287+445.491050   test-rmse:30020.949326+4147.621496 
[34]    train-rmse:4714.159076+436.616842   test-rmse:30020.728523+4125.791442 
[35]    train-rmse:4605.865235+434.948055   test-rmse:29998.502044+4144.056463 
[36]    train-rmse:4481.845249+406.109731   test-rmse:30002.710074+4154.989436 
[37]    train-rmse:4336.677598+403.956630   test-rmse:30002.324854+4166.991265 
[38]    train-rmse:4230.729911+413.982412   test-rmse:30006.219061+4163.296605 
[39]    train-rmse:4103.906363+400.602200   test-rmse:30001.508438+4149.737929 
[40]    train-rmse:3929.814336+363.534235   test-rmse:29999.908318+4161.909092 
[41]    train-rmse:3776.863250+334.887009   test-rmse:30011.006204+4149.815317 
[42]    train-rmse:3708.380418+313.742874   test-rmse:30017.758866+4143.379066 
[43]    train-rmse:3613.385365+341.675124   test-rmse:30019.163837+4144.381811 
[44]    train-rmse:3509.429889+332.549952   test-rmse:30020.637425+4132.161886 
[45]    train-rmse:3418.888903+300.138885   test-rmse:30024.265768+4129.290408 
[46]    train-rmse:3332.919636+287.333641   test-rmse:30034.830428+4119.787008 
[47]    train-rmse:3234.501152+277.408666   test-rmse:30049.058159+4112.818307 
[48]    train-rmse:3164.627897+278.116073   test-rmse:30059.250298+4110.982630 
[49]    train-rmse:3104.354860+273.673276   test-rmse:30049.608394+4117.755793 
[50]    train-rmse:3026.219515+253.766650   test-rmse:30055.577835+4109.651713 
[51]    train-rmse:2954.227647+247.088676   test-rmse:30062.656690+4102.228666 
[52]    train-rmse:2899.967433+251.864255   test-rmse:30069.935360+4113.183386 
[53]    train-rmse:2815.509723+211.872163   test-rmse:30061.557987+4109.492767 
[54]    train-rmse:2757.847076+234.076619   test-rmse:30054.703013+4113.373795 
[55]    train-rmse:2698.182467+236.766455   test-rmse:30058.670151+4120.380502 
[56]    train-rmse:2630.451918+231.780182   test-rmse:30070.919902+4125.398316 
[57]    train-rmse:2551.276971+260.753136   test-rmse:30073.497445+4129.213875 
[58]    train-rmse:2498.266264+256.014221   test-rmse:30073.584535+4126.613613 
[59]    train-rmse:2421.942141+237.371051   test-rmse:30077.259633+4122.970988 
[60]    train-rmse:2358.089692+244.010629   test-rmse:30072.976544+4129.437773 
[61]    train-rmse:2289.440043+241.482158   test-rmse:30078.633152+4121.690463 
[62]    train-rmse:2231.618822+250.514111   test-rmse:30074.245654+4119.716513 
[63]    train-rmse:2175.488801+249.112546   test-rmse:30067.017983+4102.900648 
[64]    train-rmse:2104.793851+224.988000   test-rmse:30070.586478+4101.749792 
[65]    train-rmse:2031.402099+203.667900   test-rmse:30071.342529+4100.475742 
[66]    train-rmse:1965.223623+214.787517   test-rmse:30078.532096+4105.011865 
[67]    train-rmse:1914.568847+197.234526   test-rmse:30079.368622+4100.035880 
[68]    train-rmse:1858.575340+182.470537   test-rmse:30082.468824+4100.085163 
[69]    train-rmse:1784.706064+190.124919   test-rmse:30077.858680+4116.687044 
[70]    train-rmse:1748.083192+193.763095   test-rmse:30080.309524+4112.782311 
[71]    train-rmse:1694.781542+194.409185   test-rmse:30077.488110+4112.080110 
[72]    train-rmse:1648.421792+189.844155   test-rmse:30075.520990+4113.023075 
[73]    train-rmse:1587.681767+178.839554   test-rmse:30071.698972+4113.391105 
[74]    train-rmse:1534.056950+204.014216   test-rmse:30070.566277+4116.343297 
[75]    train-rmse:1485.222889+203.302202   test-rmse:30065.405895+4114.312705 
[76]    train-rmse:1450.865208+211.798423   test-rmse:30066.302016+4109.533967 
[77]    train-rmse:1399.856595+199.105689   test-rmse:30070.056358+4107.672878 
[78]    train-rmse:1363.382935+195.842361   test-rmse:30068.443910+4105.394124 
[79]    train-rmse:1321.562738+182.773817   test-rmse:30066.923084+4108.621130 
[80]    train-rmse:1295.507525+179.397845   test-rmse:30066.193232+4113.360667 
[81]    train-rmse:1259.468966+179.250793   test-rmse:30065.425846+4108.177503 
[82]    train-rmse:1227.414080+177.119478   test-rmse:30067.918307+4101.707726 
[83]    train-rmse:1193.822765+178.019850   test-rmse:30066.591340+4097.582280 
[84]    train-rmse:1169.116438+168.798878   test-rmse:30070.688534+4096.065638 
[85]    train-rmse:1136.332131+169.094343   test-rmse:30076.907816+4096.761644 
[86]    train-rmse:1092.849018+162.296107   test-rmse:30082.326513+4104.163062 
[87]    train-rmse:1058.690050+157.044518   test-rmse:30082.033923+4102.918683 
[88]    train-rmse:1024.849577+144.392250   test-rmse:30085.117168+4106.094151 
[89]    train-rmse:999.980177+131.126085    test-rmse:30084.964031+4100.768509 
[90]    train-rmse:973.092014+134.736985    test-rmse:30083.323614+4098.684988 
[91]    train-rmse:953.925856+142.439488    test-rmse:30085.563816+4101.737427 
[92]    train-rmse:926.184678+142.184719    test-rmse:30088.264864+4099.357876 
[93]    train-rmse:889.648011+129.771496    test-rmse:30090.055655+4102.392218 
[94]    train-rmse:870.785256+123.450704    test-rmse:30090.189488+4100.364852 
[95]    train-rmse:839.854826+123.559100    test-rmse:30089.859642+4103.324194 
[96]    train-rmse:816.503404+135.085715    test-rmse:30087.567207+4102.948658 
[97]    train-rmse:792.533006+130.139913    test-rmse:30089.922093+4104.746685 
[98]    train-rmse:776.857750+130.261714    test-rmse:30088.595959+4103.767859 
[99]    train-rmse:752.077305+119.373102    test-rmse:30094.088789+4106.972139 
[100]   train-rmse:727.154242+121.908010    test-rmse:30096.892478+4104.851245 
[1] "RMSE Cross-Validation: 29998.502"</code></pre>
</div>
</div>
</section>
<section id="support-vector-regression-svr" class="level2">
<h2 class="anchored" data-anchor-id="support-vector-regression-svr">5. Support Vector Regression (SVR)</h2>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-58_a04b28f22ed10efe765af7f60c154ef0">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the SVR model</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>svr <span class="ot">&lt;-</span> <span class="fu">svm</span>(X_train, y_train, <span class="at">kernel =</span> <span class="st">"radial"</span>, <span class="at">cost =</span> <span class="dv">100000</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on the test set</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(svr, X_test)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate evaluation metrics</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> y_test))</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y_test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> mse <span class="sc">/</span> <span class="fu">var</span>(y_test)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MAE:"</span>, mae, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MSE:"</span>, mse, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE:"</span>, rmse, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R2_Score:"</span>, r_squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation to calculate RMSE</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>cv_results <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"double"</span>, folds)</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into folds and perform cross-validation</span></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>folds) {</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>  fold_indices <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="fu">nrow</span>(X), <span class="at">length.out =</span> folds <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>  fold_indices <span class="ot">&lt;-</span> fold_indices[i<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>  train_indices <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X), fold_indices)</span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>  fold_X_train <span class="ot">&lt;-</span> X[train_indices, ]</span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>  fold_y_train <span class="ot">&lt;-</span> y[train_indices]</span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>  fold_X_test <span class="ot">&lt;-</span> X[fold_indices, ]</span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>  fold_y_test <span class="ot">&lt;-</span> y[fold_indices]</span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a>  fold_svr <span class="ot">&lt;-</span> <span class="fu">svm</span>(fold_X_train, fold_y_train, <span class="at">kernel =</span> <span class="st">"radial"</span>, <span class="at">cost =</span> <span class="dv">100000</span>)</span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a>  fold_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(fold_svr, fold_X_test)</span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a>  cv_results[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((fold_predictions <span class="sc">-</span> fold_y_test)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a>cv_rmse <span class="ot">&lt;-</span> <span class="fu">mean</span>(cv_results)</span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE_CV:"</span>, cv_rmse, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new row for the model results</span></span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true" tabindex="-1"></a>new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="st">"SVR"</span>,</span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true" tabindex="-1"></a>                      <span class="at">MAE =</span> mae,</span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true" tabindex="-1"></a>                      <span class="at">MSE =</span> mse,</span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true" tabindex="-1"></a>                      <span class="at">RMSE =</span> rmse,</span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true" tabindex="-1"></a>                      <span class="at">R2_Score =</span> r_squared,</span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true" tabindex="-1"></a>                      <span class="at">RMSE_CV =</span> cv_rmse)</span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Append the new row to the models data frame</span></span>
<span id="cb75-55"><a href="#cb75-55" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">rbind</span>(models, new_row)</span>
<span id="cb75-56"><a href="#cb75-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MAE: 20515.66 
MSE: 2010782287 
RMSE: 44841.75 
R2_Score: 0.7060223 
RMSE_CV: 7096.218 </code></pre>
</div>
</div>
</section>
<section id="gradient-boosting" class="level2">
<h2 class="anchored" data-anchor-id="gradient-boosting">6.Gradient Boosting</h2>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-59_3123a8ce5f401244d68013b281023ff8">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Gradient Bossting</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>g_boost <span class="ot">&lt;-</span> <span class="fu">gbm</span>(y_train <span class="sc">~</span> ., <span class="at">data =</span> X_train, <span class="at">n.trees =</span> <span class="dv">100</span>, <span class="at">interaction.depth =</span> <span class="dv">3</span>,<span class="at">distribution =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(g_boost, <span class="at">newdata =</span> X_test, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> y_test))</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> y_test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="fu">sum</span>((y_test <span class="sc">-</span> predictions)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>((y_test <span class="sc">-</span> <span class="fu">mean</span>(y_test))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"MAE:"</span>, mae))</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"MSE:"</span>, mse))</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE:"</span>, rmse))</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"R2 Score:"</span>, r_squared))</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>rmse_cross_val <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">crossprod</span>(y_train <span class="sc">-</span> <span class="fu">predict</span>(g_boost, <span class="at">newdata =</span> X_train, <span class="at">n.trees =</span> <span class="dv">100</span>))<span class="sc">/</span>(<span class="fu">length</span>(y_train) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"RMSE_CV:"</span>, rmse_cross_val))</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Model =</span> <span class="st">"GradientBoosting"</span>, </span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">MAE =</span> mae, </span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">MSE =</span> mse, </span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">RMSE =</span> rmse, </span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">R2_Score =</span> r_squared, </span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">RMSE_CV =</span> rmse_cross_val)</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">rbind</span>(models, new_row)</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MAE: 17237.9965197921"
[1] "MSE: 877090487.880508"
[1] "RMSE: 29615.7135298224"
[1] "R2 Score: 0.871328127494256"
[1] "RMSE_CV: 21275.8554620899"</code></pre>
</div>
</div>
</section>
</section>
<section id="comparison-of-the-results-of-the-models" class="level1">
<h1>Comparison of the results of the models</h1>
<div class="cell" data-hash="Project_MAA_cache/html/unnamed-chunk-60_e2f21fda4bb3b613c75099e2ac5901f9">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>comparison_models <span class="ot">&lt;-</span> models[<span class="fu">order</span>(models<span class="sc">$</span>RMSE), ]</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>comparison_models</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Model      MAE        MSE     RMSE  R2_Score    RMSE_CV
3      RandomForest 16487.98  707359752 26596.24 0.8962000   186.4359
4      RandomForest 16487.98  707359752 26596.24 0.8962000   172.8728
5      RandomForest 16487.98  707359752 26596.24 0.8962000   174.3810
8  GradientBoosting 17238.00  877090488 29615.71 0.8713281 21275.8555
6 XGradientBoosting 17603.54 1026421853 32037.82 0.8499364 29998.5020
1  LinearRegression 20276.16 1174531451 34271.44 0.8552465 29897.7985
2      DecisionTree 28836.32 1722934536 41508.25 0.7578854 38219.5923
7               SVR 20515.66 2010782287 44841.75 0.7060223  7096.2183</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>After evaluating the R2, MAE, and RMSE scores of various ML models, it was discovered that Random Forest achieved the highest performance on the chosen dataset, with GradientBoost securing the second position.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>